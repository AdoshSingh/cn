genthroughput.awk
BEGIN {
recvdSize = 0
startTime = 1
stopTime = 0
sent=0
receive=0
}
{
event = $1
time = $2
node_id = $3
pkt_size = $6
if ( event == "+" && $5 == "cbr") {
 sent++
if (time < startTime) {
startTime = time
}
}
if (event == "-" && $5 == "cbr") {
 receive++
if (time > stopTime) {
stopTime = time
}
recvdSize += pkt_size
 }
}
END {
printf("sent_packets\t d",sent);
printf("\nreceived_packets %d",receive);
printf("\nPDR %.2f%",(receive/sent)*100);
printf("\nAverage Throughput[kbps] = %.2f\t StartTime=%.2f\t StopTime = %.2f\n", 
(recvdSize/(stopTime-startTime))*(8/1000),startTime,stopTime);
}
The awk script used for calculating end to end delay in ms is:
e2edelay.awk
BEGIN {
 seqno = -1; 
# droppedPackets = 0; 
# receivedPackets = 0; 
 count = 0;
}
{
 if($1 == "+" && seqno < $11) {
 seqno = $11;
 } 
# else if($1 == "-") {
# receivedPackets++;
# } else if ($1 == "D" && $5 == "tcp" && $6 > 500){
# droppedPackets++; 
# } 
 #end-to-end delay
 if($1 == "+") {
 start_time[$11] = $2;
 } else if(($5 == "tcp") && ($1 == "-")) {
end_time[$11] = $2;
 } else if($1 == "D" && $5 == "tcp") {
 end_time[$11] = -1;
 } 
}
END { 
 for(i=0; i<=seqno; i++) {
 if(end_time[i] > 0) {
 delay[i] = end_time[i] - start_time[i];
 count++;
 }
 else
 {
 delay[i] = -1;
 }
 }
 for(i=0; i<=seqno; i++) {
 if(delay[i] > 0) {
 n_to_n_delay = n_to_n_delay + delay[i];
 } 
 }
 n_to_n_delay = n_to_n_delay/count;
 print "Average End-to-End Delay = " n_to_n_delay * 1000 " ms";
}
Ns-3 provides helper functionality that wraps the low-level tracing system to help with the details involved 
in configuring some easily understood packet traces. If this functionality is enabled, one will see the output 
in an ASCII file-thus the name. For those familiar with ns-2 output, this type of trace is analogous to the 
out.tr generated by many scripts. Following lines of code are added: AsciiTraceHelper ascii; 
pointToPoint.EnableAsciiAll (ascii.CreateFileStream ("myfirst.tr"));
Similar to the awk script in ns2 which parses and reads the race file, this trace file created in ns3 can also 
be read by an awk script that functions according to the ns3 trace file format. An example of an awk script 
for packet_count for a node in ns3:
#!/bin/awk -f
BEGIN {
count = 0;
}
{
if($1 == “r” && $3 ~ /NodeList\/2\//)
{
count++;
}
}
END {
print “\n\tNo of packets received at the destination =
“,count,”\n\n”;
}
The ns-3 device helpers can also be used to create trace files in the .pcap format. The acronym pcap stands 
for packet capture, and is actually an API that includes the definition of a .pcap file format. The code used 
to enable pcap tracing is a one-liner: pointToPoint.EnablePcapAll ("myfirst");
To look at the promiscuous (monitor mode) trace captured on that network, type in terminal: tcpdump -
nn -tt -r myfirst.pcap
